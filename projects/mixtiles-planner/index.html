<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mixtiles Planner | Sendros.Build</title>
    <link rel="stylesheet" href="../../styles.css">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <nav>
            <a href="../../" class="logo">DS</a>
            <ul>
                <li><a href="../../#about">About</a></li>
                <li><a href="../../#projects">Projects</a></li>
                <li><a href="../../#contact">Contact</a></li>
                <li><button id="theme-toggle" aria-label="Toggle dark mode">Dark</button></li>
            </ul>
        </nav>
    </header>

    <main class="mixtiles-page">
        <h1>Mixtiles Gallery Wall Planner</h1>
        <p class="subtitle">Your wall: 54" tall × 60" wide | Drag tiles to arrange your gallery</p>

        <div class="container">
            <!-- Tile Palette -->
            <div class="panel palette-panel">
                <h2>Add Tiles</h2>
                <div class="set-selector">
                    <select id="tile-set-select" onchange="onTileSetChange(this.value)"></select>
                    <button class="btn-icon" onclick="showCreateSetModal()" title="Create new set">+</button>
                    <button class="btn-icon" onclick="showManageSetsModal()" title="Manage sets">⚙</button>
                </div>
                <div class="palette" id="palette"></div>
            </div>

            <!-- Wall Canvas -->
            <div class="panel wall-panel">
                <button class="btn-help" onclick="openHelpModal()" title="Help">?</button>
                <h2>Your Wall</h2>
                <div class="wall-container">
                    <div class="wall" id="wall"></div>
                    <div class="wall-dimensions wall-width">60"</div>
                    <div class="wall-dimensions wall-height">54"</div>
                </div>
            </div>

            <!-- Stats & Controls -->
            <div class="panel stats-panel">
                <h2>Layout Stats</h2>
                <div class="stats" id="stats">
                    <div class="stat-row">
                        <span class="stat-label">Total Tiles</span>
                        <span class="stat-value" id="total-tiles">0</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Wall Coverage</span>
                        <span class="stat-value" id="coverage">0%</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Total Cost</span>
                        <span class="stat-value" id="total-cost">$0</span>
                    </div>
                    <div class="inventory">
                        <div class="inventory-title">Tile Breakdown</div>
                        <div class="inventory-list" id="inventory"></div>
                    </div>
                </div>

                <!-- Wall Settings -->
                <div class="settings-group">
                    <h3>Wall Dimensions</h3>
                    <div class="setting-row">
                        <label for="wall-width">Width:</label>
                        <input type="number" id="wall-width" min="12" max="200" step="0.5" value="60">
                        <span class="unit">in</span>
                    </div>
                    <div class="setting-row">
                        <label for="wall-height">Height:</label>
                        <input type="number" id="wall-height" min="12" max="200" step="0.5" value="54">
                        <span class="unit">in</span>
                    </div>
                    <button class="btn btn-small" onclick="onWallSizeApply()">Apply</button>
                </div>

                <!-- Layout Settings -->
                <div class="settings-group">
                    <h3>Layout Settings</h3>
                    <div class="setting-row">
                        <input type="checkbox" id="snap-to-grid" onchange="onSnapToggle(this.checked)">
                        <label for="snap-to-grid">Snap to 0.5" grid</label>
                    </div>
                    <div class="setting-row">
                        <input type="checkbox" id="show-grid" onchange="onShowGridToggle(this.checked)">
                        <label for="show-grid">Show grid lines</label>
                    </div>
                    <div class="setting-row">
                        <label for="min-spacing">Min spacing:</label>
                        <input type="number" id="min-spacing" min="0" max="10" step="0.5" value="0" onchange="onMinSpacingChange(this.value)">
                        <span class="unit">in</span>
                    </div>
                </div>

                <!-- Save & Load -->
                <div class="settings-group">
                    <h3>Save & Load</h3>
                    <div class="controls-grid">
                        <button class="btn btn-primary" onclick="showSaveModal()">Save Layout</button>
                        <button class="btn btn-secondary" onclick="showLoadModal()">Load Layout</button>
                        <button class="btn btn-secondary" onclick="exportLayoutAsFile()">Export JSON</button>
                        <button class="btn btn-secondary" onclick="triggerImportFile()">Import JSON</button>
                        <input type="file" id="import-file-input" accept=".json" onchange="handleImportFile(event)" style="display: none;">
                    </div>
                </div>

                <div class="controls">
                    <button class="btn btn-danger" onclick="clearWall()">Clear All Tiles</button>
                    <button class="btn btn-secondary" onclick="exportLayout()">Copy Layout Data</button>
                </div>

                <div class="instructions">
                    <strong>How to use:</strong><br>
                    • Click + to add tiles to the wall<br>
                    • Drag tiles to reposition<br>
                    • Click ⟳ to rotate non-square tiles<br>
                    • Hover & click × to remove a tile<br>
                    • Tiles snap to 0.5" grid when enabled
                </div>
            </div>
        </div>
    </main>

    <!-- Save Layout Modal -->
    <div id="save-modal" class="modal hidden">
        <div class="modal-content">
            <h3>Save Layout</h3>
            <input type="text" id="layout-title" placeholder="Enter layout name...">
            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeSaveModal()">Cancel</button>
                <button class="btn btn-primary" onclick="confirmSaveLayout()">Save</button>
            </div>
        </div>
    </div>

    <!-- Load Layout Modal -->
    <div id="load-modal" class="modal hidden">
        <div class="modal-content">
            <h3>Load Layout</h3>
            <div id="saved-layouts-list" class="layouts-list"></div>
            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeLoadModal()">Close</button>
            </div>
        </div>
    </div>

    <!-- Create Set Modal -->
    <div id="create-set-modal" class="modal hidden">
        <div class="modal-content">
            <h3>Create Tile Set</h3>
            <input type="text" id="set-name" placeholder="Enter set name...">
            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeCreateSetModal()">Cancel</button>
                <button class="btn btn-primary" onclick="confirmCreateSet()">Create</button>
            </div>
        </div>
    </div>

    <!-- Manage Sets Modal -->
    <div id="manage-sets-modal" class="modal hidden">
        <div class="modal-content">
            <h3>Manage Tile Sets</h3>
            <div id="manage-sets-list" class="layouts-list"></div>
            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeManageSetsModal()">Close</button>
            </div>
        </div>
    </div>

    <!-- Create Tile Modal -->
    <div id="create-tile-modal" class="modal hidden">
        <div class="modal-content">
            <h3>Create Custom Tile</h3>
            <div class="form-group">
                <label for="tile-width">Width (inches) *</label>
                <input type="number" id="tile-width" min="1" max="100" step="0.5" required>
            </div>
            <div class="form-group">
                <label for="tile-height">Height (inches) *</label>
                <input type="number" id="tile-height" min="1" max="100" step="0.5" required>
            </div>
            <div class="form-group">
                <label for="tile-title">Title (optional)</label>
                <input type="text" id="tile-title" placeholder="e.g., Large Portrait">
                <small>Defaults to "W × H" if empty</small>
            </div>
            <div class="form-group">
                <label for="tile-price">Price (optional)</label>
                <input type="number" id="tile-price" min="0" step="0.01" placeholder="e.g., 49.99">
            </div>
            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeCreateTileModal()">Cancel</button>
                <button class="btn btn-primary" onclick="confirmCreateTile()">Add Tile</button>
            </div>
        </div>
    </div>

    <!-- Help Modal -->
    <div id="help-modal" class="modal hidden" onclick="handleHelpModalClick(event)">
        <div class="modal-content help-modal-content">
            <button class="modal-close" onclick="closeHelpModal()">&times;</button>
            <h3>Mixtiles Gallery Wall Planner</h3>

            <div class="help-section">
                <h4>About This Planner</h4>
                <p>This tool helps you visualize and plan your gallery wall arrangement. Experiment with different tile sizes and layouts to see how they'll look on your actual wall.</p>
				<p>The tool was built to be used with <a href="https://www.mixtiles.com">Mixtiles</a> frame sizes, but you can build custom frame sizes so that it works with any project.</p>
            </div>

            <div class="help-section">
                <h4>Key Features</h4>
                <ul>
                    <li><strong>Drag &amp; Drop:</strong> Click and drag tiles to reposition them on the wall</li>
                    <li><strong>Snap to Grid:</strong> Enable grid snapping for precise 0.5" alignment</li>
                    <li><strong>Minimum Spacing:</strong> Set required spacing between tiles to ensure even gaps</li>
                    <li><strong>Rotation:</strong> Click the rotate button on non-square tiles to flip orientation</li>
                    <li><strong>Save &amp; Load:</strong> Save your layouts and reload them later</li>
                    <li><strong>Custom Tile Sets:</strong> Create your own tile sizes for non-Mixtiles projects</li>
                </ul>
            </div>

            <div class="help-section">
                <h4>How to Use</h4>
                <ol>
                    <li><strong>Set Wall Size:</strong> Enter your actual wall dimensions in the Layout Stats panel</li>
                    <li><strong>Add Tiles:</strong> Click the + button next to any tile size in the palette</li>
                    <li><strong>Arrange:</strong> Drag tiles to position them on the wall</li>
                    <li><strong>Fine-tune:</strong> Use snap-to-grid and spacing controls for precision</li>
                    <li><strong>Review:</strong> Check the tile breakdown and total cost</li>
                    <li><strong>Save:</strong> Save your layout for future reference</li>
                </ol>
            </div>

            <div class="modal-actions">
                <button class="btn btn-primary" onclick="closeHelpModal()">Got it!</button>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
